"use strict";var Console={time:function(){},timeEnd:function(){},log:function(){},error:function(e){console.error(e)}};!function(e){function o(o){window.BeePlugin=new function(){Console.log("[Loader] new function()");var l=o,d=o,r={},a={},s={},c={},i={},u={},g={},p=null,f=null;function h(e){var o;if(Console.log("[Loader] _handleMessage()",e),e&&e.data&&e.data.action&&e.data.args){if("onReady"===e.data.action)return Console.log("[Loader] _iframe.onload",i),window.performance.mark("[Loader] _iframe.onload"),m("init",{token:s,config:i}),void b(100,100);"onContentDialog"===e.data.action&&c.contentDialog&&c.contentDialog[e.data.args[0]]?(o=e.data.args[1]||{},c.contentDialog[e.data.args[0]].handler?c.contentDialog[e.data.args[0]].handler.apply(window,[function(e){return m("resolveContentDialog",e)},function(e){return m("rejectContentDialog",e)},o]):m("rejectContentDialog")):"onHook"===e.data.action&&c.hooks&&c.hooks[e.data.args[0]]?(o=e.data.args[1]||{},c.hooks[e.data.args[0]].handler?c.hooks[e.data.args[0]].handler.apply(window,[function(e){return m("resolveHook",e)},function(){return m("rejectHook")},o]):m("rejectHook")):"function"==typeof c[e.data.action]&&c[e.data.action].apply(window,e.data.args)}}function w(e){Console.log("[Loader] _createIframe",e),(u=document.createElement("iframe")).id=c.container+"__bee-plugin-frame",e=e,Console.log("[Loader] _setIframeStyle",e),e?u.setAttribute("style","height:100%;width:100%;min-width:1024px;border:0px"):u.setAttribute("style","height:0px;width:0px;position:absolute;left:-9999px;"),u.setAttribute("onmousewheel","");e=x(s);u.src=d+"?appMode="+e}function _(e){e=document.getElementById(c.container+"__bee-plugin-"+e);e&&g.removeChild(e)}function m(e,o){Console.log("[Loader] _trigger",e),u.contentWindow.postMessage({action:e,data:o},"*")}function C(){Console.log("[Loader] _handleOnInit"),this&&"function"==typeof this&&this(e)}function b(o,e){var t,n,r;Console.log("[Loader] _updateProgressBar",e),clearInterval(p),t={delay:10,duration:e,delta:function(e){return 1-Math.sin(Math.acos(e))},step:function(e){a.style.width=o*e+"%"}},Console.log("[Loader] _animate",t),n=new Date,r=setInterval(function(){var e=(new Date-n)/t.duration,o=t.delta(e=1<e?1:e);t.step(o),1==e&&clearInterval(r)},t.delay||10),p=r}var e={start:function(e,o){Console.log("[Loader] start",e),r.setAttribute("style","height:0px;width:0px;position:absolute;left:-9999px;"),u.setAttribute("style","height:100%;width:100%;min-width:1024px;border:0px;background-color: #32373A"),e&&m("load",f?e:{template:e,options:o})},picker:function(){Console.log("[Loader] picker"),r.setAttribute("style","height:0px;width:0px;position:absolute;left:-9999px;"),u.setAttribute("style","height:100%;width:100%;min-width:1024px;border:0px;background-color: #32373A"),m("picker","")},load:function(e){Console.log("[Loader] start",e),m("load",f?e:{template:e})},reload:function(e,o){Console.log("[Loader] reload",e),m("reload",{template:e,options:o})},join:function(e){Console.log("[Loader] join session",e),r.setAttribute("style","height:0px;width:0px;position:absolute;left:-9999px;"),u.setAttribute("style","height:100%;width:100%;min-width:1024px;border:0px;background-color: #32373A"),e&&m("join",e)},save:function(){m("save",{})},saveAsTemplate:function(){m("saveAsTemplate",{})},send:function(){m("send",{})},preview:function(){m("preview",{})},togglePreview:function(){m("togglePreview",{})},toggleMergeTagsPreview:function(){m("toggleMergeTagsPreview",{})},toggleStructure:function(){m("toggleStructure",{})},toggleComments:function(){m("toggleComments",{})},loadWorkspace:function(e){m("loadWorkspace",e)},loadStageMode:function(e){m("loadStageMode",e)},loadConfig:function(e){m("loadConfig",e)},exec:function(e){m("exec",e)},showComment:function(e){m("showComment",e)},loadRows:function(e){m("loadRows",e)},updateToken:function(e){m("updateToken",e)}};function v(e,o,t,n){Console.log("[Loader] _createBee",t),c.onInit=C.bind(n),Console.log("[Loader] _createBee STEP "),Console.log("[Loader] _extractUserConfiguration()"),i=JSON.parse(JSON.stringify(c)),Console.log("[Loader] _addMessageHandler"),window.removeEventListener("message",h),window.addEventListener("message",h),["loader","frame"].forEach(_),Console.log("[Loader] _createLoader"),(r=document.createElement("div")).id=c.container+"__bee-plugin-loader",r.setAttribute("style","height:100%;width:100%;border:0px;margin:0px;background-color:#32373A;position:relative;"),(t=document.createElement("div")).id="bee-plugin-loader-pbar-bg",t.setAttribute("style","border:0px;margin:0 auto;padding:0px;background-color:#666666;position: absolute;   height: 5px;   width: 100%;   top: 50%;      border-radius: 3px;left: 50%;max-width: 500px;-webkit-transform: translate(-50%, -50%);     transform: translate(-50%, -50%);"),(a=document.createElement("div")).id="bee-plugin-loader-pbar-fg",a.setAttribute("style","  border: 0px; margin: 0px; padding: 0px; background-color: #FFFFFF;border-radius: 3px;position: absolute;height: 5px;width: 100%;top: 50%;margin-top: -2.5px;max-width: 500px;"),t.appendChild(a),r.appendChild(t),w(!1),Console.log("[Loader] _createBee STEP "),u.onload=function(){c.onInit=C.bind(n),o?(Console.log("[Loader] isAngular TRUE "),m("init",{token:s,config:i}),b(100,100)):Console.log("[Loader] isAngular FALSE ")},Console.log("[Loader] _createBee STEP "),g.appendChild(r),g.appendChild(u),b(75,3e3)}function n(e){e=(e=e.split(".")[1]).replace(/-/g,"+").replace(/_/g,"/"),e=decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)}function x(e){try{var o;if(e.access_token)return n(e.access_token).product_handle||"nl";if(e.non_field_errors)return console.log(e.non_field_errors),o=e.non_field_errors,Console.log("[Loader] WARNING token with auth error:"+o),"static/auth-error"}catch(e){Console.log("[Loader] WARNING no product type found")}return"nl"}function L(e){try{var o,t;if(e.access_token)return(o="no_version"===(o=n(e.access_token).plugin_version)?"static/no-version":o)||"static/no-version";if(e.non_field_errors)return console.log(e.non_field_errors),t=e.non_field_errors,Console.log("[Loader] WARNING token with auth error:"+t),"static/auth-error"}catch(e){Console.log("[Loader] WARNING no version found")}return"static/generic-error"}this.create=function(e,o,t,n){Console.log("[Loader] create with token:",e),Console.log("[Loader] create with mask:",l);var r,a=L(e),i=x(e),n=(Console.log("[Loader] create with pluginVersion:",a),Console.log("[Loader] create with pluginProdType:",i),null),n=(Console.log("[Loader] create with bucket_dir:",n),d=(d=l).replace("__VERSION__",a=n?n:a),-1!==(d=d.replace("__PROD_TYPE__",i)).indexOf("static/")),i=0==a.indexOf("v19.04.29.1450");f=i,Console.log("[Loader] create with url:",d),a=n,e=e,r=o,Console.log("[Loader] _validateInput",r),a||(s=e||{}),(c=r||{}).container=c.container||"bee-plugin",(g=document.getElementById(c.container))?n?(w(!0),g.appendChild(u)):v(0,i,o,t):console.error("Container not specified or invalid. Application cannot start.")}}}if(window.BeePlugin&&window.BeePlugin._queue&&0<window.BeePlugin._queue.length){Console.log("[Loader] window.BeePlugin",window.BeePlugin);var t=window.BeePlugin._queue.slice(0);o(e);for(var n=0;n<t.length;n++)window.BeePlugin[t[n][0]].apply(window.BeePlugin,t[n][1])}else Console.log("[Loader] createBeePlugin",e),o(e)}("https://app.getbee.io/__PROD_TYPE__/__VERSION__/index.html");